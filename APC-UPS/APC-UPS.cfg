# Alienvault plugin
# Author: js
# Plugin APC-UPS id:90016 version: 1.0

[DEFAULT]
plugin_id=90016

[config]
type=detector
enable=yes

source=log
location=/var/log/apc.log

# create log file if it does not exists,
# otherwise stop processing this plugin
create_file=false
process=
start=no   ; launch plugin process when agent starts
stop=no     ; shutdown plugin process when agent stops
restart=no  ; restart plugin process after each interval
restart_interval=
startup=
shutdown=

[translation]
0x0001=1
0x0002=2
0x0003=3
0x0007=7
0x0008=8
0x000C=12
0x000D=13
0x000F=15
0x0014=20
0x0015=21
0x0016=22
0x001E=30
0x001F=31
0x0020=32
0x0018=24
0x0019=25
0x001A=26
0x0024=36
0x0025=37
0x0026=38
0x0027=39
0x002A=42
0x002B=43
0x002C=44
0x0101=257
0x0102=258
0x0103=259
0x0104=260
0x0105=261
0x0106=262
0x0107=263
0x0108=264
0x0109=265
0x010A=266
0x010B=267
0x010C=268
0x010D=269
0x010E=270
0x010F=271
0x0110=272
0x0113=275
0x0114=276
0x0115=277
0x0116=278
0x0117=279
0x0119=281
0x011A=282
0x011B=283
0x011C=284
0x011D=285
0x011E=286
0x011F=287
0x0121=289
0x0122=290
0x0123=291
0x0124=292
0x0125=293
0x0126=294
0x0127=295
0x0128=296
0x0129=297
0x012A=298
0x012B=299
0x012C=300
0x012D=301
0x012F=303
0x0130=304
0x0131=305
0x0132=306
0x0133=307
0x0201=513
0x0202=514
0x0203=515
0x0204=516
0x0205=517
0x0206=518
0x0207=519
0x0208=520
0x0209=521
0x020A=522
0x020B=523
0x020C=524
0x020D=525
0x020E=526
0x020F=527
0x0210=528
0x0211=529
0x0212=530
0x0213=531
0x0214=532
0x0215=533
0x0216=534
0x0217=535
0x0218=536
0x0219=537
0x021A=538
0x021B=539
0x021C=540
0x021D=541
0x021E=542
0x021F=543
0x0220=544
0x0221=545
0x0222=546
0x0223=547
0x0224=548
0x0227=551
0x0228=552
0x0229=553
0x022A=554
0x022B=555
0x022C=556
0x022D=557
0x022E=558
0x022F=559
0x0230=560
0x0231=561
0x0232=562
0x0233=563
0x0234=564
0x0235=565
0x0236=566
0x0237=567
0x0238=568
0x0239=569
0x023A=570
0x023B=571
0x023C=572
0x023D=573
0x023E=574
0x023F=575
0x0240=576
0x0241=577
0x0242=578
0x0243=579
0x0244=580
0x0245=581
0x0246=582
0x0247=583
0x0248=584
0x0249=585
0x024A=586
0x024B=587
0x024C=588
0x024D=589
0x024E=590
0x024F=591
0x0250=592
0x0251=593
0x0252=594
0x0253=595
0x0254=596
0x0A01=2561
0x0A02=2562
0x0A03=2563
0x0A04=2564
0x0A05=2565
0x0A06=2566
0x0A07=2567
0x0A08=2568
0x0A09=2569
0x0A0A=2570
0x0A0B=2571
0x0A0C=2572
0x0A0D=2573
0x0A0E=2574
0x0A0F=2575
0x0A10=2576
0x0A11=2577
0x0A12=2578
0x0A13=2579
0x0A14=2580
0x0A15=2581
0x0A16=2582
0x0A17=2583
0x0A18=2584
0x0A19=2585
0x0A1A=2586
0x0A1B=2587
0x0A1C=2588
0x0A1D=2589
0x0A1E=2590
0x0A1F=2591
0x0A20=2592
0x0A21=2593
0x0A22=2594
0x0A23=2595
0x0A24=2596
0x0A25=2597
0x0A26=2598
0x0A27=2599
0x0A28=2600
0x0A29=2601
0x0A2A=2602
0x0A2B=2603
0x0A2C=2604
0x0A2D=2605
0x0A2E=2606
0x0A2F=2607
0x0A30=2608
0x0A31=2609
0x0A32=2610
0x0A33=2611
0x0A34=2612
0x0A35=2613
0x0A36=2614
0x0A37=2615
0x0A38=2616
0x0A39=2617
0x0A3A=2618
0x0A3B=2619
0x0A3C=2620
0x0A3D=2621
0x0A3E=2622
0x0A3F=2623
0x0A40=2624
0x0A41=2625
0x0A42=2626
0x0A43=2627
0x0A44=2628
0x0A45=2629
0x0A46=2630
0x0A47=2631
0x0A48=2632
0x0A49=2633
0x0A4A=2634
0x0A4B=2635
0x0A4C=2636
0x0A4D=2637
0x0A4E=2638
0x0A4F=2639
0x0A50=2640
0x0A51=2641
0x0A52=2642
0x0A53=2643
0x0A54=2644
0x0A55=2645
0x0A56=2646
0x0A57=2647
0x0A58=2648
0x0A59=2649
0x0A5A=2650
0x0A5B=2651
0x0A5C=2652
0x0A5D=2653
0x0A5E=2654
0x0A5F=2655
0x0A60=2656
0x0A61=2657
0x0A62=2658
0x0A63=2659
0x0A64=2660
0x0A65=2661
0x0A66=2662
0x0A67=2663
0x0A68=2664
0x0A69=2665
0x0A6A=2666
0x0A6B=2667
0x0A6C=2668
0x0A6D=2669
0x0A6E=2670
0x0A6F=2671
0x0A70=2672
0x0A71=2673
0x0A72=2674
0x0A73=2675
0x0A74=2676
0x0A75=2677
0x0A76=2678
0x0A77=2679
0x0A78=2680
0x0A79=2681
0x0A7A=2682
0x0A7B=2683
0x0A7C=2684
0x0A7D=2685
0x0A7E=2686
0x0A7F=2687
0x0A80=2688
0x0301=769
0x0302=770
0x0303=771
0x0304=772
0x0305=773
0x0306=774
0x0307=775
0x0308=776
0x0309=777
0x030A=778
0x030B=779
0x030C=780
0x030D=781
0x030E=782
0x030F=783
0x0310=784
0x0311=785
0x0312=786
0x0313=787
0x0314=788
0x0315=789
0x0316=790
0x0317=791
0x0318=792
0x0319=793
0x031A=794
0x031B=795
0x031C=796
0x031D=797
0x031F=799
0x0321=801
0x0322=802
0x0323=803
0x0324=804
0x0325=805
0x0326=806
0x0004=4
0x0005=5
0x0006=6
0x0225=549
0x0226=550
0x031E=798
0x0320=800


[simplematch]
event_type=event
precheck=0x
regexp=(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?P<device>\S+)\s.*?(?P<code>0x\w{4})
plugin_sid={translate($code)}
date={normalize_date($date)}
device={resolv($device)}
src_ip={resolv($device)}

